授权代码授权类型用于获取访问令牌和刷新令牌，并针对机密客户端进行了优化。由于这是基于重定向，因此客户端必须能够与资源所有者的用户代理（通常是Web浏览器）进行交互，并且能够从授权服务器接收传入请求（通过重定向）。

```
     +----------+
     | Resource |
     |   Owner  |
     |          |
     +----------+
          ^
          |
         (B)
     +----|-----+          Client Identifier      +---------------+
     |         -+----(A)-- & Redirection URI ---->|               |
     |  User-   |                                 | Authorization |
     |  Agent  -+----(B)-- User authenticates --->|     Server    |
     |          |                                 |               |
     |         -+----(C)-- Authorization Code ---<|               |
     +-|----|---+                                 +---------------+
       |    |                                         ^      v
      (A)  (C)                                        |      |
       |    |                                         |      |
       ^    v                                         |      |
     +---------+                                      |      |
     |         |>---(D)-- Authorization Code ---------'      |
     |  Client |          & Redirection URI                  |
     |         |                                             |
     |         |<---(E)----- Access Token -------------------'
     +---------+       (w/ Optional Refresh Token)
```

注意:说明步骤\(A\)、\(B\)和\(C\)在通过用户代理时分为两部分。

 图3:授权代码流程

图3中所示的流程包括以下步骤：

\(A\) 客户端通过将资源所有者的用户代理指向授权端点来启动流。客户端包括其客户端标识符，请求的范围，本地状态以及授权服务器在授予（或拒绝）访问权限后将用户代理发送回的重定向URI。

\(B\)授权服务器对资源所有者进行身份验证（通过用户代理），并确定资源所有者是否授予或拒绝客户端的访问请求。

\(C\)假设资源所有者授予访问权限，授权服务器使用先前提供的重定向URI（在请求中或在客户端注册期间）将用户代理重定向回客户端。重定向URI包括授权代码和客户端先前提供的任何本地状态。

\(D\)客户端通过包括在上一步骤中接收的授权代码来请求来自授权服务器的令牌端点的访问令牌。发出请求时，客户端使用授权服务器进行身份验证。 客户端包括用于获取验证授权码的重定向URI。

\(E\)授权服务器对客户端进行身份验证，验证授权代码，并确保收到的重定向URI与步骤（C）中用于重定向客户端的URI相匹配。如果有效，授权服务器将使用访问令牌和可选的刷新令牌进行响应。

